!function(e){var t={};function a(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=7)}([function(e,t,a){"use strict";const n="https://aeqlmvgvlxcee.elma365.ru/api/extensions/3d15932c-766e-4e91-b8ff-fed442649de2/script/get/appgs?id="+$("#elma-id").html();!async function(){try{const e=await async function(e){return await fetch(e,{method:"GET",headers:{"Content-Type":"application/json","X-Token":"8657d620-f5eb-4552-997d-d3ec43688c29"}})}(n),t=await e.json(),a=await Object.entries(t);for(const[e,t]of a){$(`[data-info=${e}]`).html(t)}}catch(e){throw console.log(e),e}}()},function(e,t){function a(e){const t=e.val(),a=e.data("condRelation");if(!a)return;$(`[data-cond-dep-name="${a}"]`).each((function(){const e=$(this).data("condDepValue");if(e.includes("|,|")){const a=e.split("|,|");if(a.includes(t)&&$(this).hasClass("show"))return;return a.includes(t)&&!$(this).hasClass("show")?void $(this).addClass("show"):void $(this).removeClass("show")}e===t&&$(this).hasClass("show")||(e!==t||$(this).hasClass("show")?$(this).removeClass("show"):$(this).addClass("show"))}))}jQuery(".select").length>1?(jQuery("select").each((function(){let e=jQuery(this).not(".select-search"),t=jQuery(this).not(".select-search").parents(".select");e.select2({minimumResultsForSearch:1/0,dropdownParent:t}).on("select2:select",(function(t){a(e)}))})),jQuery(".select-search").each((function(){let e=jQuery(this),t=jQuery(this).parents(".select");e.select2({dropdownParent:t}).on("select2:select",(function(t){a(e)}))}))):jQuery("select").select2({minimumResultsForSearch:1/0,dropdownParent:jQuery(".select")}),$(".select").parent().on("click",(function(){const e=$(this),t=e.find(".select-input");e.find(".select2-selection__rendered").on("DOMSubtreeModified",(function(){const e=$(this).html();e.includes("Другое")?t.addClass("active"):!e.includes("Другое")&&t.hasClass("active")&&t.removeClass("active")}))}))},function(e,t){$(".contact-form__form-field.check").each((function(){const e=$(this).find('input[type="checkbox"]'),t=$(this).find('input[type="hidden"]'),a=$(this).find('input[type="text"]');e.each((function(){$(this).on("change",(function(){const e=$(this).prop("checked"),a=t.val();if(e)return a.includes($(this).val())?void 0:(t.val(`${a} | ${$(this).val()}`),void console.log(t.val()));if(a.includes($(this).val())){const e=a.replace(" | "+$(this).val(),"");t.val(e),console.log(t.val())}}))})),a.on("focus",(function(){if(""===$(this).val())return;const e=t.val();if(e.includes($(this).val())){const a=e.replace(" | "+$(this).val(),"");t.val(a),console.log(t.val())}})),a.on("blur",(function(){if(""===$(this).val())return;const e=t.val();t.val(`${e} | ${$(this).val()}`),console.log(t.val())}))}))},function(e,t){jQuery("#datepicker").datepicker({changeMonth:!0,changeYear:!0,showButtonPanel:!0,minDate:new Date(90,0,1),monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],dayNamesShort:["вск","пнд","втр","срд","чтв","птн","сбт"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],weekHeader:"Не",dateFormat:"dd.mm.yy",firstDay:1,onSelect:function(){const e=$(this).val();$(".date-mask").val(e),jQuery("#datepicker").toggleClass("active")}}),jQuery(".calendar").on("click",(function(){$(this).toggleClass("active"),$("#datepicker").toggleClass("active")}))},function(e,t){!function(){const e=document.querySelector(".train"),t=$(".train__hide-input"),a=[...document.querySelectorAll(".train__item_inner")];let n=null,s=null;function i(e,t){o(e,t);const n=[...document.querySelectorAll(".train__item.active")];if(n.length&&n.forEach(e=>e.classList.remove("active")),e===t)return e=null,void(t=null);a.forEach(a=>{const n=parseInt(a.innerHTML);n>=e&&n<=t&&a.parentElement.classList.add("active")})}function o(e=0,a=0){const n=e?e+"":0,s=a?a+"":0;n?s?t.val(`${n}-${s}`):t.val(n):t.val("")}e.addEventListener("click",(function(e){const t=e.target;if(!t.classList.contains("train__item_inner"))return;const a=parseInt(t.innerHTML);if(!n)return n=a,t.parentElement.classList.add("active"),void o(n,s);if(n===a||s===a)return void i(0,0);n>a?(s=n,n=a,i(n,s)):a>n&&a<s?(n=a,i(n,s)):(s=a,i(n,s))}))}()},function(e,t){$("[data-cond-relation]").each((function(){if($(this).is("select"))return;const e=$(this).data("condRelation"),t=$(`[data-cond-dep-name="${e}"]`);$(this).on("change",(function(){let e=$(this).val();"checkbox"===$(this).attr("type")?e=$(this).prop("checked"):"radio"===$(this).attr("type")&&(e="Да"===$(this).val()),t.each((function(){const t=$(this).data("condDepValue");if("string"==typeof t&&t.includes("|,|")){const a=t.split("|,|");if(a.includes(e)&&$(this).hasClass("show"))return;return a.includes(e)&&!$(this).hasClass("show")?void $(this).addClass("show"):void $(this).removeClass("show")}t===e&&$(this).hasClass("show")||(t!==e||$(this).hasClass("show")?$(this).removeClass("show"):$(this).addClass("show"))}))}))}))},function(e,t){ymaps.ready((function(){function e(e){var t=$(e).val();ymaps.geocode(t).then((function(t){var a,n=t.geoObjects.get(0);if(n)switch(n.properties.get("metaDataProperty.GeocoderMetaData.precision")){case"exact":break;case"number":case"near":case"range":a="Неточный адрес, требуется уточнение","Уточните номер дома";break;case"street":a="Неполный адрес, требуется уточнение","Уточните номер дома";break;case"other":default:a="Неточный адрес, требуется уточнение","Уточните адрес"}else a="Адрес не найден","Уточните адрес";a&&function(e,t){const a=e.parent().find(".error");$(a).text(t),$(e).addClass("error"),$(a).css("display","block")}(e,a)}),(function(e){console.log(e)}))}$("input.address").parent().each((function(){const t=$(this).find("input"),a=t.attr("id");new ymaps.SuggestView(a);t.on("blur",(function(){e(t)}))}))}))},function(e,t,a){"use strict";a.r(t);a(0),a(1),a(2),a(3),a(4);const n=async()=>{try{const e=await fetch(homeUrl+"/mkb.json"),t=await e.json();return await t}catch(e){console.log(e)}};window.addEventListener("click",(function(e){const t=e.target,a=document.querySelector(".tips.active")||null;a&&(t.classList.contains("tip")||t.classList.contains("city")||a.classList.remove("active"))}));const s=e=>{console.log(e);const t=document.querySelector(".tips");t.innerHTML="",e.forEach(e=>{const a=document.createElement("span");a.classList.add("tip"),a.innerHTML=e.title,a.addEventListener("click",i),t.appendChild(a)})},i=function(e){document.querySelector('[data-elma="mank_accompanying_diagnosis_2"]').value=this.innerHTML,(()=>{const e=$(".tips.active");e&&e.removeClass("active")})()},o=()=>{const e=$(".lk-progress-inner"),t=$(".lk-form__tabs").children().length,a=`${$(".lk-form__tab.locked").length}/${t}`;e.html(a)},c=(e,t)=>{$(e).each((function(){$(this).on("click",(function(a){if(a.preventDefault(),$(this).hasClass("active"))return;const n=$(this).data("tab"),s=$(`${t}[data-form="${n}"]`);var i,o;$(e+".active").removeClass("active"),$(t+".active").removeClass("active"),$(this).addClass("active"),s.addClass("active"),i=e,o=`${t}, ${n}`,window.localStorage.setItem(i,o)}))}))},r=e=>{const t=(a=e,window.localStorage.getItem(a));var a;if(!t)return;const n=t.split(","),s=n[0],i=n[1];l(e,s,i)},l=(e,t,a)=>{const n=Number(a),s=$(e)[n-1],i=$(t+"[data-form]")[n-1];$(s).hasClass("active")||($(e+".active")&&($(e+".active").removeClass("active"),$(t+".active").removeClass("active")),$(s).addClass("active"),console.log($(i)),$(i).addClass("active"))},d=e=>{const t=$(e).find('[data-req="true"]'),a=Object.create({});return t.each((function(){const e=$(this).attr("name");let t={value:{required:!0}};switch($(this).data("validation")){case"email":t={value:{required:!0,email:!0}};break;case"name":t={value:{required:!0,_name:!0}}}Object.defineProperty(a,e,t)})),a},u=(e,t)=>{const a=t.data("elma");if(""===a)return;const n=t.val();Object.defineProperty(e,a,{value:n,enumerable:!0})},h=e=>{const t=e.find("[data-elma]"),a=Object.create({});return Object.defineProperty(a,"context",{value:{},enumerable:!0}),t.each((function(){if($(this).is("select")){if($(this).val().includes("Другое")){const e=$(this).parent().parent(),t=$(e).find(".select-input .select-input__input"),n=$(this).data("elma");return t.data("elma",n),void u(a.context,t)}}("radio"!==$(this).attr("type")||$(this).prop("checked"))&&u(a.context,$(this))})),a},f=e=>{const t=$(".lk-form__tab"),a=$(`.lk-form__tab[data-tab="${e}"]`),n=$(`.lk-form__tab_content[data-form="${e}"]`);a.addClass("locked"),n.addClass("locked");let s="";t.each((function(){$(this).hasClass("locked")&&(s+=$(this).data("tab")+",")}));const i=new FormData;i.set("tabs_string",s),i.set("user_email","asdfd1231312312a@as.asa"),fetch(homeUrl+"/api/medical-questionnare-tabs.php",{method:"POST",body:i});if($(".lk-form__tab.locked").length===t.length){const e=$(".lk-tab.active"),t=parseInt(e.data("tab")),n=$(`.lk-tab[data-tab="${t+1}"]`);return a.removeClass("active"),void n.trigger("click")}let c;for(let a=e;a<t.length;a++)if(!$(t[a]).hasClass("locked")){c=t[a];break}if(!c)for(let a=0;a<e;a++)if(!$(t[a]).hasClass("locked")){c=t[a];break}o(),setTimeout(()=>{$(c).trigger("click")},1500)};jQuery("form.contact-form__form").each((function(){const e=d(jQuery(this)),t=$(this);jQuery(this).validate({ignore:[],errorClass:"error",validClass:"success",rules:e,errorElement:"span",errorPlacement:function(e,t){const a=jQuery(t).data("error");a?jQuery(a).append(e):e.insertBefore(t)},submitHandler:function(){t.find(".loader").addClass("active");const e=parseInt(t.parent().parent().parent().data("form")),a=`https://aeqlmvgvlxcee.elma365.ru/api/extensions/3d15932c-766e-4e91-b8ff-fed442649de2/script/ward/${e?"medical":"main"}/update`,n=h(t),s=$("#elma-id").html();let i;i=e?JSON.stringify({id:s,form_id:e,context:n.context}):JSON.stringify({id:s,context:n.context}),((e,t)=>{const a=$(`[name=${e}]`).val();t.forEach(e=>{const t=$(`[name=${e}]`);t.val()||t.val(a)})})("main_info_address_reg_pod",["main_info_address_act_pod","main_info_address_mail_pod"]),fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 8657d620-f5eb-4552-997d-d3ec43688c29"},body:i}).then(e=>e.json()).then(a=>{((e,t)=>{const a=t.find(".loader"),n=t.find(".result");return"success"===e?(t.trigger("reset"),n.html("Ответы сохранены, переход к следующему блоку"),n.hasClass("success")&&n.removeClass("success"),n.addClass("success"),a.removeClass("active"),!0):(n.html("Ошибка отправки. Проверьте данные или попробуйте позже."),n.addClass("err"),a.removeClass("active"),!1)})(a.msg,t)&&f(e,$(".lk-form__tab_content[data-form]").length)}).catch((function(e){console.log("Request failed",e)}))}})})),jQuery.validator.addMethod("email",(function(e,t){return this.optional(t)||/\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,6}/.test(e)}),"Некорректный e-mail"),jQuery.validator.addMethod("_name",(function(e,t){return this.optional(t)||/^[а-яА-ЯёЁ\s]+$/.test(e)}),"Введите корректное имя");a(5),a(6);r(".lk-tab"),r(".lk-form__tab"),fetch(homeUrl+"/api/medical-questionnare-tabs.php?user_email=asdfd1231312312a@as.asa",{method:"GET"}).then(e=>e.text()).then(e=>{e&&e.split(",").forEach(e=>{const t=parseInt(e),a=$(`.lk-form__tab[data-tab="${t}"]`),n=$(`.lk-form__tab_content[data-form="${t}"]`);a.addClass("locked"),n.addClass("locked")})}).then(()=>{o()}),c(".lk-tab",".lk-form"),c(".lk-form__tab",".lk-form__tab_content"),jQuery(".phone-mask").inputmask({mask:"+7(999)999-99-99",clearIncomplete:!0}),jQuery(".date-mask").inputmask({mask:"99.99.9999",clearIncomplete:!0}),(async e=>{const t=$(`[data-elma="${e}"]`);if(!t)return;const a=await n();t.on("keypress",(function(){const e=$(this).val().toLowerCase(),t=$(this).parent().find(".tips");if(e.length<2)return;t.hasClass("active")||t.addClass("active");const n=a.filter(t=>t.title.toLowerCase().includes(e));s(n)}))})("mank_accompanying_diagnosis_2")}]);