!function(e){var t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=6)}({6:function(e,t,a){"use strict";a.r(t);const r=async(e,t)=>{const a={...{headers:{"Content-Type":"application/json","X-Token":"8657d620-f5eb-4552-997d-d3ec43688c29"}},...t};try{return await fetch(e,a)}catch(e){return e}},n=homeUrl+"/custom_auth/",i=async(e,...t)=>{const a=Object.create({});Object.defineProperty(a,"user_data",{value:{},enumerable:!0,writable:!0}),t.forEach(e=>{const t=e.name,r=e.value||"";Object.defineProperty(a.user_data,t,{value:r,enumerable:!0,writable:!0})});const r=`${n}${e}.php`,i=new FormData;return i.set("user_data",JSON.stringify(a)),await(async(e="",t={})=>{try{return await fetch(e,{method:"POST",mode:"no-cors",body:t})}catch(e){return!1}})(r,i)},s=function(e){this.email=e,this.checkUser=async()=>{try{const e=await(async(e,t)=>{const a={name:"user_email",value:e},r={name:"user_name",value:t};return await i("create-user",a,r)})(this.email);return await e.text()}catch(e){return`User with email ${this.email} already exist`}},this.getElmaIdByEmail=async()=>{try{const t="https://aeqlmvgvlxcee.elma365.ru/api/extensions/3d15932c-766e-4e91-b8ff-fed442649de2/script/search_guardianship_by_email",a={method:"POST",body:JSON.stringify({context:{email:e}})},n=await r(t,a);return await n.json()}catch(e){return e}},this.sendUserPasswordToElma=async(e,t)=>{try{const a=JSON.stringify({context:{id:e,password:t}}),n="https://aeqlmvgvlxcee.elma365.ru/api/extensions/3d15932c-766e-4e91-b8ff-fed442649de2/script/old_base/appupdate",i={method:"POST",body:a},s=await r(n,i);return await s.json()}catch(e){return"Failed to create password"}},this.createNewUser=async e=>{try{return await(async(e,t)=>{const a={name:"user_email",value:e},r={name:"elma_id",value:t};return await i("create-user-elma-id",a,r)})(this.email,e)}catch(e){return"Error"}},this.hideModal=()=>{const e=document.querySelector(".modal--register");e.parentElement.removeChild(e)}};registerEmail&&window.addEventListener("load",async()=>{const e=new s(registerEmail),t=await e.checkUser();if(await t){const a=await e.getElmaIdByEmail();if(await a.id){const r=await e.createNewUser(a.id),n=await e.sendUserPasswordToElma(a.id,t);await r&&await n&&e.hideModal()}}})}});