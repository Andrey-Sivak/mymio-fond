!function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=async(e,t)=>{const n={...{headers:{"Content-Type":"application/json","X-Token":"8657d620-f5eb-4552-997d-d3ec43688c29"}},...t};try{return await fetch(e,n)}catch(e){return e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e="body",t,n="active")=>{let a;a="string"==typeof e?$(e).find(".loader"):e.find(".loader"),a&&("show"!==t?a.hasClass(n)&&a.removeClass(n):a.addClass(n))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));const a=homeUrl+"/custom_auth/",i=async(e,...t)=>{const n=Object.create({});Object.defineProperty(n,"user_data",{value:{},enumerable:!0,writable:!0}),t.forEach(e=>{const t=e.name,a=e.value||"";Object.defineProperty(n.user_data,t,{value:a,enumerable:!0,writable:!0})});const i=`${a}${e}.php`,s=new FormData;return s.set("user_data",JSON.stringify(n)),await(async(e="",t={})=>{try{return await fetch(e,{method:"POST",mode:"no-cors",body:t})}catch(e){return!1}})(i,s)},s=async(e,t)=>{const n={name:"user_email",value:e},a={name:"user_name",value:t};return await i("create-user",n,a)},r=async e=>{const t={name:"user_email",value:e};return await i("delete-user",t)},o=async e=>{try{return await fetch(e,{headers:{Accept:"application/json","Content-Type":"application/json"},mode:"no-cors"})}catch(e){return!1}}},,function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(2),s=n(1);const r=function(e){const t=this;this.email=e,this.modalWindow=document.querySelector(".modal--register"),this.modal=function(){const e=t.modalWindow,n=e.querySelector(".modal--content"),a=e.querySelector(".modal--btn");this.changeContent=e=>{n.innerHTML=e},this.finish=t=>{t&&this.changeContent(t),a.classList.contains("hide")&&a.classList.remove("hide"),e.dataset.close="true",e.addEventListener("click",this.hideModal),window.history.pushState(null,document.title,window.location.pathname)},this.hideModal=function(e){e.preventDefault();e.target.dataset.close&&t.modalWindow.classList.remove("active")}},this.refusalRequest=async()=>{const n=new t.modal,i={method:"POST",body:JSON.stringify({email:e})};Object(a.a)("https://aeqlmvgvlxcee.elma365.ru/api/extensions/3d15932c-766e-4e91-b8ff-fed442649de2/script/old_base/cancel",i).then(n.finish()).catch(n.finish("Ошибка сервера. <br>Попробуйте позднее"))},this.init=async()=>{window.addEventListener("load",async()=>{await this.refusalRequest()})}};if(registerEmail){new function(e){const t=this;this.email=e,this.modalWindow=document.querySelector(".modal--register"),this.checkUser=async()=>{try{const e=await Object(i.a)(this.email);return await e.json()}catch(e){return!1}},this.getElmaIdByEmail=async()=>{try{const t="https://aeqlmvgvlxcee.elma365.ru/api/extensions/3d15932c-766e-4e91-b8ff-fed442649de2/script/search_guardianship_by_email",n={method:"POST",body:JSON.stringify({context:{email:e}})},i=await Object(a.a)(t,n);return await i.json()}catch(e){return!1}},this.sendUserPasswordToElma=async(e,t)=>{try{const n=JSON.stringify({context:{id:e,password:t.user_pass}}),i="https://aeqlmvgvlxcee.elma365.ru/api/extensions/3d15932c-766e-4e91-b8ff-fed442649de2/script/old_base/appupdate",s={method:"POST",body:n},r=await Object(a.a)(i,s);return await r.json()}catch(e){return!1}},this.check=async()=>{const e=await this.checkUser();let t=!0;const n=new this.modal;if(await e.status){n.changeContent("Создание id пользователя...");const a=await this.getElmaIdByEmail();if(await a.id){n.changeContent("Создание учетной записи...");const i=await this.sendUserPasswordToElma(a.id,e);await i?n.finish("Готово!"):(t=!1,n.finish("Ошибка сервера. Попробуйте позже."))}else t=!1,n.finish("Ошибка сервера. Попробуйте позже.")}else n.finish(`Пользователь с email "${this.email}" уже зарегистрирован.`);t||await Object(i.b)(this.email)},this.modal=function(){const e=t.modalWindow,n=e.querySelector(".modal--content"),a=e.querySelector(".modal--btn");this.changeContent=e=>{n.innerHTML=e},this.finish=t=>{this.changeContent(t),Object(s.a)(".modal--register"),a.classList.contains("hide")&&a.classList.remove("hide"),e.dataset.close="true",e.addEventListener("click",this.hideModal),window.history.pushState(null,document.title,window.location.pathname)},this.hideModal=function(e){e.preventDefault();e.target.dataset.close&&t.modalWindow.classList.remove("active")}},this.init=()=>{window.addEventListener("load",async()=>{await this.check()})}}(registerEmail).init()}if(wardRefusalEmail){new r(wardRefusalEmail).init()}}]);