!function(t){var e={};function n(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(a,i,function(e){return t[e]}.bind(null,i));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));const a=async(t,e)=>{const n={...{headers:{"Content-Type":"application/json","X-Token":"a9521f77-657f-4830-9c9b-d81c3b6de22d"}},...e};try{return await fetch(t,n)}catch(t){return!1}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));const a=(t="body",e,n="active")=>{let a;a="string"==typeof t?$(t).find(".loader"):t.find(".loader"),a&&("show"!==e?a.hasClass(n)&&a.removeClass(n):a.addClass(n))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o}));const a=homeUrl+"/custom_auth/",i=async(t,...e)=>{const n=Object.create({});Object.defineProperty(n,"user_data",{value:{},enumerable:!0,writable:!0}),e.forEach(t=>{const e=t.name,a=t.value||"";Object.defineProperty(n.user_data,e,{value:a,enumerable:!0,writable:!0})});const i=`${a}${t}.php`,s=new FormData;return s.set("user_data",JSON.stringify(n)),await(async(t="",e={})=>{try{return await fetch(t,{method:"POST",mode:"no-cors",body:e})}catch(t){return!1}})(i,s)},s=async(t,e)=>{const n={name:"user_email",value:t},a={name:"user_name",value:e};return await i("create-user",n,a)},r=async t=>{const e={name:"user_email",value:t};return await i("delete-user",e)},o=async t=>{try{return await fetch(t,{headers:{Accept:"application/json","Content-Type":"application/json"},mode:"no-cors"})}catch(t){return!1}}},,function(t,e,n){"use strict";n.r(e);var a=n(0),i=n(2),s=n(1);const r=function(t){const e=this;this.email=t,this.modalWindow=document.querySelector(".modal--register"),this.modal=function(){const t=e.modalWindow,n=t.querySelector(".modal--content"),a=t.querySelector(".modal--btn");this.changeContent=t=>{n.innerHTML=t},this.finish=e=>{e&&this.changeContent(e),a.classList.contains("hide")&&a.classList.remove("hide"),t.dataset.close="true",t.addEventListener("click",this.hideModal),window.history.pushState(null,document.title,window.location.pathname)},this.hideModal=function(t){t.preventDefault();t.target.dataset.close&&e.modalWindow.classList.remove("active")}},this.refusalRequest=async()=>{const n=new e.modal,i={method:"POST",body:JSON.stringify({email:t})};Object(a.a)("https://3mxk6vwcpahuu.elma365.ru/api/extensions/49bd5171-49b3-4dec-aba8-be894465f9d9/script/old_base/cancel",i).then(t=>t.json()).then(t=>{t.status?n.finish('Нам очень жаль, что вы не смогли быть с нами.\n                    <br>С уважением к Вашему решению,\n                    <br>фонд "МойМио"'):n.finish("Ошибка сервера. <br>Попробуйте позднее")}).catch(t=>{n.finish("Ошибка сервера. <br>Попробуйте позднее"),console.log(t)})},this.init=async()=>{window.addEventListener("load",async()=>{await this.refusalRequest()})}};if(registerEmail){new function(t){const e=this;this.email=t,this.modalWindow=document.querySelector(".modal--register"),this.checkUser=async()=>{try{const t=await Object(i.a)(this.email);return await t.json()}catch(t){return!1}},this.getElmaIdByEmail=async()=>{try{const e="https://3mxk6vwcpahuu.elma365.ru/api/extensions/49bd5171-49b3-4dec-aba8-be894465f9d9/script/search_guardianship_by_email",n={method:"POST",body:JSON.stringify({context:{email:t}})},i=await Object(a.a)(e,n);return await i.json()}catch(t){return!1}},this.sendUserPasswordToElma=async(t,e)=>{try{const n=JSON.stringify({context:{id:t,password:e.user_pass}}),i="https://3mxk6vwcpahuu.elma365.ru/api/extensions/49bd5171-49b3-4dec-aba8-be894465f9d9/script/old_base/appupdate",s={method:"POST",body:n},r=await Object(a.a)(i,s);return await r.json()}catch(t){return!1}},this.check=async()=>{const t=await this.checkUser();let e=!0;const n=new this.modal;if(await t.status){n.changeContent("Создание id пользователя...");const a=await this.getElmaIdByEmail();if(await a.id){n.changeContent("Создание учетной записи...");const i=await this.sendUserPasswordToElma(a.id,t);await i?n.finish("Готово!"):(e=!1,n.finish("Ошибка сервера. Попробуйте позже."))}else e=!1,n.finish("Ошибка сервера. Попробуйте позже.")}else n.finish(`Пользователь с email "${this.email}" уже зарегистрирован.`);e||await Object(i.b)(this.email)},this.modal=function(){const t=e.modalWindow,n=t.querySelector(".modal--content"),a=t.querySelector(".modal--btn");this.changeContent=t=>{n.innerHTML=t},this.finish=e=>{this.changeContent(e),Object(s.a)(".modal--register"),a.classList.contains("hide")&&a.classList.remove("hide"),t.dataset.close="true",t.addEventListener("click",this.hideModal),window.history.pushState(null,document.title,window.location.pathname)},this.hideModal=function(t){t.preventDefault();t.target.dataset.close&&e.modalWindow.classList.remove("active")}},this.init=()=>{window.addEventListener("load",async()=>{await this.check()})}}(registerEmail).init()}if(wardRefusalEmail){new r(wardRefusalEmail).init()}}]);